diff --git a/bot.py b/bot.py
index 1111111..2222222 100644
--- a/bot.py
+++ b/bot.py
@@
-BACK_RE = r"^(?:üîô\s*)?–ù–∞–∑–∞–¥$"
-
-
-async def on_any_back(update: Update, context: ContextTypes.DEFAULT_TYPE):
-    return await end_and_main_menu(update, context)
-
-from telegram.ext import ConversationHandler
+BACK_RE = r"^(?:üîô\s*)?–ù–∞–∑–∞–¥$"
+
+# –ï–¥–∏–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –≤–æ –≤—Å–µ —Å–ª—É—á–∞–∏
+async def safe_return(update: Update, context: ContextTypes.DEFAULT_TYPE, text: str = "‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é."):
+    """–ï–¥–∏–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ –ª—é–±–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è (inline –∏–ª–∏ message)."""
+    chat_id = update.effective_chat.id
+    uid = update.effective_user.id
+
+    # —Ñ–∏–∫—Å: –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–æ–ª—å –î–û –æ—á–∏—Å—Ç–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
+    is_master = uid == MASTER_ID
+    is_controlling = "target_id" in context.user_data
+
+    # –ø–æ–¥—á–∏—Å—Ç–∏–º —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—è
+    for k in ("inv_cat", "inv_page", "inv_items", "remove_cat", "page", "items",
+              "add_cat", "pending_item", "pending_desc", "raw_name", "pending"):
+        context.user_data.pop(k, None)
+
+    # –≤—ã–±–∏—Ä–∞–µ–º –Ω—É–∂–Ω–æ–µ –º–µ–Ω—é
+    if is_master:
+        if is_controlling:
+            kb = home_kb(update, context)
+            msg = "‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–º."
+        else:
+            kb = _kb_master_root()
+            msg = "‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –≤ –º–∞—Å—Ç–µ—Ä-–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å."
+    else:
+        kb = home_kb(update, context)
+        msg = text
+
+    await context.bot.send_message(chat_id=chat_id, text=msg, reply_markup=kb)
+    return ConversationHandler.END
@@
 async def on_inventory_item(update: Update, context: ContextTypes.DEFAULT_TYPE):
     q = update.callback_query
     await q.answer()
@@
-    await q.message.reply_text(
-        card,
-        parse_mode=constants.ParseMode.MARKDOWN,
-        disable_web_page_preview=True
-    )
-    return await end_and_main_menu(update, context)
+    await q.message.reply_text(
+        card,
+        parse_mode=constants.ParseMode.MARKDOWN,
+        disable_web_page_preview=True
+    )
+    await asyncio.sleep(0.2)
+    return await safe_return(update, context)
@@
     await notify_master(context.bot, update.effective_user.first_name, f"—É–¥–∞–ª–∏–ª –ø—Ä–µ–¥–º–µ—Ç: [{cat}] {item}")
-
-    await q.edit_message_text(f"‚ùå –£–¥–∞–ª–µ–Ω–æ: [{cat}] {item}")
-    return await end_and_main_menu(update, context)
+    await q.edit_message_text(f"‚ùå –£–¥–∞–ª–µ–Ω–æ: [{cat}] {item}")
+    await asyncio.sleep(0.3)
+    return await safe_return(update, context)
@@
     # –∫–∞—Å—Ç–æ–º
-    inv[cat].append(make_custom_string(name, user_desc))
-    save_inventory(uid, inv)
+    custom_entry = make_custom_string(name, user_desc).strip()
+    inv.setdefault(cat, [])
+    if custom_entry not in inv[cat]:
+        inv[cat].append(custom_entry)
+    save_inventory(uid, inv)
@@
 async def on_add_confirm_button(update: Update, context: ContextTypes.DEFAULT_TYPE):
     q = update.callback_query
     await q.answer()
